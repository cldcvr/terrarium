# Copyright (c) Ollion
# SPDX-License-Identifier: Apache-2.0

profiles:
    - id: dev
    - id: prod
    - id: staging
components:
    - id: bucket
      title: Bucket
      inputs:
        type: object
        properties:
            name:
                title: Name
                type: string
                default: ""
      outputs:
        type: object
        properties:
            uri:
                title: Uri
    - id: environment
      title: Environment
      inputs:
        type: object
      outputs:
        type: object
    - id: postgres
      title: Postgres
      inputs:
        type: object
        properties:
            version:
                title: Version
                type: string
                default: "11"
      outputs:
        type: object
        properties:
            host:
                title: Host
                description: The host address of the PostgreSQL server.
            name:
                title: Name
            password:
                title: Password
            port:
                title: Port
                description: The port number on which the PostgreSQL server is listening.
graph:
    - id: local.tr_component_bucket
      requirements: []
    - id: local.tr_component_postgres
      requirements: []
    - id: module.tr_component_bucket
      requirements:
        - local.tr_component_bucket
    - id: module.tr_component_environment
      requirements: []
    - id: module.tr_component_postgres
      requirements:
        - local.tr_component_postgres
        - var.instance_type
    - id: output.tr_component_bucket_uri
      requirements:
        - module.tr_component_bucket
    - id: output.tr_component_postgres_host
      requirements:
        - module.tr_component_postgres
    - id: output.tr_component_postgres_name
      requirements:
        - module.tr_component_postgres
    - id: output.tr_component_postgres_password
      requirements:
        - module.tr_component_postgres
    - id: output.tr_component_postgres_port
      requirements:
        - module.tr_component_postgres
    - id: var.instance_type
      requirements: []
