components:
  - id: rdbms
    taxonomy: [storage, database]
    title: Relational Database
    description: A relational database management system.
    inputs:
      properties: # JSON schema format
        version:
          type: number
          title: Engine Version
          description: The version of PostgreSQL to use.
        engine:
          type: string
          title: Database Engine
          description: The engine of the database.
        db_name:
          type: string
          title: Database Name
          description: The name of the database.
    outputs:
      properties:
        host:
          type: string
          title: Host
          description: The host address of the PostgreSQL server.
        port:
          type: number
          title: Port
          description: The port number on which the PostgreSQL server is listening.
        username:
          type: string
          title: Username
          description: The username for accessing the PostgreSQL database.
        password:
          type: string
          title: Password
          description: The password for accessing the PostgreSQL database.

  - id: postgres
    taxonomy: [storage, database, rdbms]
    title: PostgreSQL Database
    description: A relational database management system using SQL.
    extends:
      id: rdbms
      inputs:
        engine: postgres

  - id: postgres@11
    taxonomy: [storage, database, rdbms, postgres]
    title: PostgreSQL Database v11
    description: A relational database management system using SQL.
    extends:
      id: postgres
      inputs:
        version: 11

  - id: redis
    taxonomy: [storage, cache, in_memory]
    title: Redis Cache
    description: An in-memory data structure store used as a cache or message broker.
    inputs:
      properties:
        version:
          type: string
          title: Engine Version
          description: The version of Redis to use.
    outputs:
      properties:
        host:
          type: string
          title: Host
          description: The host address of the Redis server.
        port:
          type: string
          title: Port
          description: The port number on which the Redis server is listening.

  - id: service.static_site
    taxonomy: [service]
    title: Static Website
    description: A static website hosted on a Content Delivery Network (CDN) with SSL support.
    inputs:
      properties:
        path_redirect_rewrites:
          type: array
          title: Redirect and Rewrite Rules
          description: Add Redirect or Rewrite Rules to modify requests to your site without writing code. You can use URL parameters to capture path segments, and wildcards to redirect everything under a given path.
          items:
            type: object
            properties:
              source:
                type: string
                title: Source
              destination:
                type: string
                title: Destination
              action:
                type: string
                enum: [Redirect, Rewrite]
                title: Action
    outputs:
      properties:
        cdn_url:
          type: string
          title: CDN URL
          description: The URL of the static website on the CDN.

  - id: service.web
    taxonomy: [service]
    title: Web Service
    description: A compute resource that provides SSL, HTTP, and GRPC endpoints.
    inputs:
      properties:
        port:
          type: string
          title: Service Port
          description: The port number on which the service is listening.
    outputs:
      properties:
        endpoint:
          type: string
          title: Service Endpoint
          description: The endpoint URL of the web service.

  - id: service.private
    taxonomy: [service]
    title: Private Service
    description: A compute resource accessible only within a private network.
    inputs:
      properties:
        port:
          type: number
          description: The port number on which the service is listening.
        protocol:
          type: string
          description: The protocol used by the service (e.g., TCP, UDP).

  - id: service.background
    taxonomy: [service]
    title: Background Service
    description: A compute resource that listens to queues and performs background tasks.

  - id: service.cron_jobs
    taxonomy: [service]
    title: Cron Jobs
    description: Scheduled tasks that run at specific intervals.
    inputs:
      properties:
        schedule:
          type: string
          title: Schedule
          description: The time interval or pattern for the cron job to run.
          pattern: '^(\S+\s+){4}\S+$'
          examples:
            - '*/5 * * * *'
            - '0 0 * * MON'

graph:
  - id: module.tr_component_rdbms
    connections:
    - module.code_vpc
    - module.vpc_endpoint
    - module.db_security_group
  - id: module.tr_component_redis
    connections:
    - module.code_vpc
    - module.vpc_endpoint
    - module.cache_security_group
  - id: module.code_vpc
    connections:
      - variable.xyz
      - data.xyz.abc
